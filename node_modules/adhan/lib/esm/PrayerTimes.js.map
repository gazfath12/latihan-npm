{"version":3,"sources":["../../src/PrayerTimes.ts"],"names":["SolarTime","TimeComponents","Prayer","Astronomical","dateByAddingDays","dateByAddingMinutes","dateByAddingSeconds","dayOfYear","isValidDate","roundedMinute","shadowLength","PolarCircleResolution","polarCircleResolvedValues","PrayerTimes","constructor","coordinates","date","calculationParameters","solarTime","fajrTime","sunriseTime","dhuhrTime","asrTime","sunsetTime","maghribTime","ishaTime","nightFraction","transit","utcDate","getFullYear","getMonth","getDate","sunrise","sunset","tomorrow","tomorrowSolarTime","polarCircleResolver","polarCircleResolution","isNaN","Unresolved","resolved","dateComponents","afternoon","madhab","tomorrowSunrise","night","Number","hourAngle","fajrAngle","method","latitude","safeFajr","seasonAdjustedMorningTwilight","portion","nightPortions","fajr","getTime","ishaInterval","ishaAngle","safeIsha","seasonAdjustedEveningTwilight","shafaq","isha","maghribAngle","angleBasedMaghrib","fajrAdjustment","adjustments","methodAdjustments","sunriseAdjustment","dhuhrAdjustment","dhuhr","asrAdjustment","asr","maghribAdjustment","maghrib","ishaAdjustment","rounding","timeForPrayer","prayer","Fajr","Sunrise","Dhuhr","Asr","Maghrib","Isha","currentPrayer","Date","None","nextPrayer"],"mappings":"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","sourcesContent":["import SolarTime from './SolarTime';\nimport TimeComponents from './TimeComponents';\nimport Prayer from './Prayer';\nimport Astronomical from './Astronomical';\nimport CalculationParameters from './CalculationParameters';\nimport Coordinates from './Coordinates';\nimport {\n  dateByAddingDays,\n  dateByAddingMinutes,\n  dateByAddingSeconds,\n  dayOfYear,\n  isValidDate,\n  roundedMinute,\n} from './DateUtils';\nimport { shadowLength } from './Madhab';\nimport {\n  PolarCircleResolution,\n  polarCircleResolvedValues,\n} from './PolarCircleResolution';\nimport { ValueOf } from './TypeUtils';\n\nexport default class PrayerTimes {\n  fajr: Date;\n  sunrise: Date;\n  dhuhr: Date;\n  asr: Date;\n  sunset: Date;\n  maghrib: Date;\n  isha: Date;\n\n  // eslint-disable-next-line complexity\n  constructor(\n    public coordinates: Coordinates,\n    public date: Date,\n    public calculationParameters: CalculationParameters,\n  ) {\n    let solarTime = new SolarTime(date, coordinates);\n\n    let fajrTime: Date;\n    let sunriseTime: Date;\n    let dhuhrTime: Date;\n    let asrTime: Date;\n    let sunsetTime: Date;\n    let maghribTime: Date;\n    let ishaTime: Date;\n\n    let nightFraction;\n\n    dhuhrTime = new TimeComponents(solarTime.transit).utcDate(\n      date.getFullYear(),\n      date.getMonth(),\n      date.getDate(),\n    );\n    sunriseTime = new TimeComponents(solarTime.sunrise).utcDate(\n      date.getFullYear(),\n      date.getMonth(),\n      date.getDate(),\n    );\n    sunsetTime = new TimeComponents(solarTime.sunset).utcDate(\n      date.getFullYear(),\n      date.getMonth(),\n      date.getDate(),\n    );\n    const tomorrow = dateByAddingDays(date, 1);\n    let tomorrowSolarTime = new SolarTime(tomorrow, coordinates);\n\n    const polarCircleResolver = calculationParameters.polarCircleResolution;\n    if (\n      (!isValidDate(sunriseTime) ||\n        !isValidDate(sunsetTime) ||\n        isNaN(tomorrowSolarTime.sunrise)) &&\n      polarCircleResolver !== PolarCircleResolution.Unresolved\n    ) {\n      const resolved = polarCircleResolvedValues(\n        polarCircleResolver,\n        date,\n        coordinates,\n      );\n      solarTime = resolved.solarTime;\n      tomorrowSolarTime = resolved.tomorrowSolarTime;\n      const dateComponents = [\n        date.getFullYear(),\n        date.getMonth(),\n        date.getDate(),\n      ] as const;\n\n      dhuhrTime = new TimeComponents(solarTime.transit).utcDate(\n        ...dateComponents,\n      );\n      sunriseTime = new TimeComponents(solarTime.sunrise).utcDate(\n        ...dateComponents,\n      );\n      sunsetTime = new TimeComponents(solarTime.sunset).utcDate(\n        ...dateComponents,\n      );\n    }\n\n    // eslint-disable-next-line prefer-const\n    asrTime = new TimeComponents(\n      solarTime.afternoon(shadowLength(calculationParameters.madhab)),\n    ).utcDate(date.getFullYear(), date.getMonth(), date.getDate());\n\n    const tomorrowSunrise = new TimeComponents(\n      tomorrowSolarTime.sunrise,\n    ).utcDate(tomorrow.getFullYear(), tomorrow.getMonth(), tomorrow.getDate());\n    const night = (Number(tomorrowSunrise) - Number(sunsetTime)) / 1000;\n\n    fajrTime = new TimeComponents(\n      solarTime.hourAngle(-1 * calculationParameters.fajrAngle, false),\n    ).utcDate(date.getFullYear(), date.getMonth(), date.getDate());\n\n    // special case for moonsighting committee above latitude 55\n    if (\n      calculationParameters.method === 'MoonsightingCommittee' &&\n      coordinates.latitude >= 55\n    ) {\n      nightFraction = night / 7;\n      fajrTime = dateByAddingSeconds(sunriseTime, -nightFraction);\n    }\n\n    const safeFajr = (function () {\n      if (calculationParameters.method === 'MoonsightingCommittee') {\n        return Astronomical.seasonAdjustedMorningTwilight(\n          coordinates.latitude,\n          dayOfYear(date),\n          date.getFullYear(),\n          sunriseTime,\n        );\n      } else {\n        const portion = calculationParameters.nightPortions().fajr;\n        nightFraction = portion * night;\n        return dateByAddingSeconds(sunriseTime, -nightFraction);\n      }\n    })();\n\n    if (isNaN(fajrTime.getTime()) || safeFajr > fajrTime) {\n      fajrTime = safeFajr;\n    }\n\n    if (calculationParameters.ishaInterval > 0) {\n      ishaTime = dateByAddingMinutes(\n        sunsetTime,\n        calculationParameters.ishaInterval,\n      );\n    } else {\n      ishaTime = new TimeComponents(\n        solarTime.hourAngle(-1 * calculationParameters.ishaAngle, true),\n      ).utcDate(date.getFullYear(), date.getMonth(), date.getDate());\n\n      // special case for moonsighting committee above latitude 55\n      if (\n        calculationParameters.method === 'MoonsightingCommittee' &&\n        coordinates.latitude >= 55\n      ) {\n        nightFraction = night / 7;\n        ishaTime = dateByAddingSeconds(sunsetTime, nightFraction);\n      }\n\n      const safeIsha = (function () {\n        if (calculationParameters.method === 'MoonsightingCommittee') {\n          return Astronomical.seasonAdjustedEveningTwilight(\n            coordinates.latitude,\n            dayOfYear(date),\n            date.getFullYear(),\n            sunsetTime,\n            calculationParameters.shafaq,\n          );\n        } else {\n          const portion = calculationParameters.nightPortions().isha;\n          nightFraction = portion * night;\n          return dateByAddingSeconds(sunsetTime, nightFraction);\n        }\n      })();\n\n      if (isNaN(ishaTime.getTime()) || safeIsha < ishaTime) {\n        ishaTime = safeIsha;\n      }\n    }\n\n    maghribTime = sunsetTime;\n    if (calculationParameters.maghribAngle) {\n      const angleBasedMaghrib = new TimeComponents(\n        solarTime.hourAngle(-1 * calculationParameters.maghribAngle, true),\n      ).utcDate(date.getFullYear(), date.getMonth(), date.getDate());\n      if (sunsetTime < angleBasedMaghrib && ishaTime > angleBasedMaghrib) {\n        maghribTime = angleBasedMaghrib;\n      }\n    }\n\n    const fajrAdjustment =\n      (calculationParameters.adjustments.fajr || 0) +\n      (calculationParameters.methodAdjustments.fajr || 0);\n    const sunriseAdjustment =\n      (calculationParameters.adjustments.sunrise || 0) +\n      (calculationParameters.methodAdjustments.sunrise || 0);\n    const dhuhrAdjustment =\n      (calculationParameters.adjustments.dhuhr || 0) +\n      (calculationParameters.methodAdjustments.dhuhr || 0);\n    const asrAdjustment =\n      (calculationParameters.adjustments.asr || 0) +\n      (calculationParameters.methodAdjustments.asr || 0);\n    const maghribAdjustment =\n      (calculationParameters.adjustments.maghrib || 0) +\n      (calculationParameters.methodAdjustments.maghrib || 0);\n    const ishaAdjustment =\n      (calculationParameters.adjustments.isha || 0) +\n      (calculationParameters.methodAdjustments.isha || 0);\n\n    this.fajr = roundedMinute(\n      dateByAddingMinutes(fajrTime, fajrAdjustment),\n      calculationParameters.rounding,\n    );\n    this.sunrise = roundedMinute(\n      dateByAddingMinutes(sunriseTime, sunriseAdjustment),\n      calculationParameters.rounding,\n    );\n    this.dhuhr = roundedMinute(\n      dateByAddingMinutes(dhuhrTime, dhuhrAdjustment),\n      calculationParameters.rounding,\n    );\n    this.asr = roundedMinute(\n      dateByAddingMinutes(asrTime, asrAdjustment),\n      calculationParameters.rounding,\n    );\n    this.sunset = roundedMinute(sunsetTime, calculationParameters.rounding);\n    this.maghrib = roundedMinute(\n      dateByAddingMinutes(maghribTime, maghribAdjustment),\n      calculationParameters.rounding,\n    );\n    this.isha = roundedMinute(\n      dateByAddingMinutes(ishaTime, ishaAdjustment),\n      calculationParameters.rounding,\n    );\n  }\n\n  timeForPrayer(prayer: ValueOf<typeof Prayer>) {\n    if (prayer === Prayer.Fajr) {\n      return this.fajr;\n    } else if (prayer === Prayer.Sunrise) {\n      return this.sunrise;\n    } else if (prayer === Prayer.Dhuhr) {\n      return this.dhuhr;\n    } else if (prayer === Prayer.Asr) {\n      return this.asr;\n    } else if (prayer === Prayer.Maghrib) {\n      return this.maghrib;\n    } else if (prayer === Prayer.Isha) {\n      return this.isha;\n    } else {\n      return null;\n    }\n  }\n\n  currentPrayer(date = new Date()) {\n    if (date >= this.isha) {\n      return Prayer.Isha;\n    } else if (date >= this.maghrib) {\n      return Prayer.Maghrib;\n    } else if (date >= this.asr) {\n      return Prayer.Asr;\n    } else if (date >= this.dhuhr) {\n      return Prayer.Dhuhr;\n    } else if (date >= this.sunrise) {\n      return Prayer.Sunrise;\n    } else if (date >= this.fajr) {\n      return Prayer.Fajr;\n    } else {\n      return Prayer.None;\n    }\n  }\n\n  nextPrayer(date = new Date()) {\n    if (date >= this.isha) {\n      return Prayer.None;\n    } else if (date >= this.maghrib) {\n      return Prayer.Isha;\n    } else if (date >= this.asr) {\n      return Prayer.Maghrib;\n    } else if (date >= this.dhuhr) {\n      return Prayer.Asr;\n    } else if (date >= this.sunrise) {\n      return Prayer.Dhuhr;\n    } else if (date >= this.fajr) {\n      return Prayer.Sunrise;\n    } else {\n      return Prayer.Fajr;\n    }\n  }\n}\n"],"file":"PrayerTimes.js"}